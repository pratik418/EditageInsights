package com.test.automation.uiAutomation.homepage;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.Assert;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

public class TC_001VerifyLoginWithInvalidCredentials {
	
	WebDriver driver;
	explicitWait wait = PageFactory.initElements(driver, explicitWait.class);

	@BeforeTest
	public void setup() {
		System.setProperty("webdriver.gecko.driver",System.getProperty("user.dir")+ "/drivers/geckodriver.exe");
		driver = new FirefoxDriver();
		driver.get("http://ei.editage.com/insights/");
		wait.waitForLoad(driver);
		driver.manage().window().maximize();
	}

	@Test
	public void invalidLoginCredentials() {
		WebElement signIn = driver.findElement(By.xpath("//div[@class='anonymous-login anonymous-text']/a"));
		signIn.click();
		WebElement iframeElement = driver.findElement(By.id("IF1"));
		driver.switchTo().frame("rufous-sandbox");
		WebElement overlay = driver.findElement(By.xpath("//div[@class='overlay-close']"));
		wait.waitForElementFluently(overlay,30);
		WebElement email = driver.findElement(By.id("edit-name--2"));
		WebElement password = driver.findElement(By.id("edit-pass--2"));
		WebElement login	= driver.findElement(By.id("edit-submit--3"));
		email.sendKeys("authenticated-user-test@mailinator.com");
		password.sendKeys("asd");
		login.click();
		wait.waitForElementToBeInvisible(By.xpath("//div[@class='overlay-close']"), 30);		
		WebElement message = driver.findElement(By.xpath("//div[@class='messages messages--error']/a"));
		String errorMessage = message.getText();
		Assert.assertEquals("Forgot Password?", errorMessage);
		
	}

	@AfterClass
	public void endTest() {
		driver.close();

	}

}
