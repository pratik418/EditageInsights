package com.test.automation.uiAutomation.homepage;

import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.PageFactory;
import org.testng.Assert;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

public class TC_001VerifyLoginWithInvalidCredentials {
	
	WebDriver driver;
	explicitWait wait = PageFactory.initElements(driver, explicitWait.class);

	@BeforeTest
	public void setup() {
		System.setProperty("webdriver.chrome.driver",System.getProperty("user.dir")+ "/drivers/chromedriver.exe");
		driver = new ChromeDriver();
		driver.get("http://ei.editage.com/insights/");
		wait.waitForLoad(driver);
		driver.manage().window().maximize();
	}

	@Test
	public void invalidLoginCredentials() throws InterruptedException {
		WebElement signIn = driver.findElement(By.xpath("//div[@class='anonymous-login anonymous-text']/a"));
		signIn.click();
		//WebElement iframeElement = driver.findElement(By.id("rufous-sandbox"));
		//driver.switchTo().frame(iframeElement);
		WebElement overlay = driver.findElement(By.xpath("//div[@id='mini-panel-register_popup']"));
		wait.waitForElementFluently(overlay,30);
		WebElement email = driver.findElement(By.id("edit-name--2"));
		WebElement password = driver.findElement(By.id("edit-pass--2"));
		WebElement login	= driver.findElement(By.id("edit-submit--3"));
		JavascriptExecutor jse = (JavascriptExecutor)driver;
		jse.executeScript("arguments[0].value='authenticated-user-test@mailinator.com';", email);
		jse.executeScript("arguments[0].value='asd';", password);
		login.click();
		Thread.sleep(1000);
		wait.waitForElementToBeInvisible(By.xpath("//div[@class='overlay-close']"), 30);
		Thread.sleep(1000);
		WebElement message = driver.findElement(By.xpath("//div[@class='messages messages--error']/h2"));		
		String errorMessage = message.getText();
		Assert.assertEquals("Error message", errorMessage);
		
	}

	@AfterClass
	public void endTest() {
		driver.close();

	}

}
